(function(n,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(n=typeof globalThis<"u"?globalThis:n||self,o(n.HotKeysController={}))})(this,function(n){"use strict";var A=Object.defineProperty;var T=(n,o,a)=>o in n?A(n,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[o]=a;var u=(n,o,a)=>(T(n,typeof o!="symbol"?o+"":o,a),a);class o{constructor(i="",e=!1){Object.defineProperty(this,"allEvents",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"onceCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"eventsPrefix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoPrefix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.eventsPrefix=i,this.autoPrefix=e}getEventName(i,e=this.autoPrefix){return this.eventsPrefix&&e?`${this.eventsPrefix}:${i}`:i}on(i,e){let t=this.getEventName(i);return this.events[t]=this.events[t]||new Set,this.events[t].add(e),this}off(i,e){let t=this.getEventName(i);return this.events[t]?(this.events[t].delete(e),this):this}one(i,e){let t=this.getEventName(i);return this.events[t]=new Set([e]),this}once(i,e){let t=this.getEventName(i);return this.events[t]=this.events[t]||new Set,this.events[t].add(e),this.onceCallbacks[t]=this.onceCallbacks[t]||new Set,this.onceCallbacks[t].add(e),this}onAll(i){return this.allEvents.add(i),this}offAll(i){return this.allEvents.delete(i),this}emit(i,e){let t=this.getEventName(i,!0);return this.allEvents.forEach(r=>r(i,e)),this.events[t]&&this.events[t].forEach(r=>{var h,l;r(e),(l=(h=this.onceCallbacks[t])==null?void 0:h.has)!=null&&l.call(h,r)&&(this.off(i,r),this.onceCallbacks[t].delete(r))}),this}}const a=(s,i)=>Object.assign({},i,s),v=s=>typeof s=="string"?document.querySelector(s):(s!=null&&s.$el&&typeof s.$el=="object"&&(s=s.$el),typeof s=="object"&&"addEventListener"in s?s:null),m=s=>{const i=/Key|Digit/;return s.replace(i,"")},f={CTRL:"CTRL",SHIFT:"SHIFT",ALT:"ALT",META:"META"},y={CTRL:new Set(["ControlLeft","ControlRight"]),SHIFT:new Set(["ShiftLeft","ShiftRight"]),ALT:new Set(["AltLeft","AltRight"]),META:new Set(["MetaLeft","MetaRight"])},E=s=>{let i=new Set;const{ctrlKey:e,altKey:t,shiftKey:r,metaKey:h,code:l}=s;h&&i.add(f.META),e&&i.add(f.CTRL),t&&i.add(f.ALT),r&&i.add(f.SHIFT);const c=m(l);let _=!1;for(const g of i){const p=y[g];if(!p)break;if(p.has(c)){_=!0;break}}return _||i.add(c),[...i].join("+")},d={el:null,autoEnable:!0,debug:!1,tabindex:0};class b extends o{constructor(e={},t=[]){super();u(this,"_options");u(this,"_actions",[]);u(this,"_restoreTabindex",null);u(this,"_isEnabled",!1);u(this,"_onKeyDown",e=>{var r,h;const t=E(e);if(e.hotKey=t,this._options.debug){const l={event:e,hotKey:t};console.log(l),this.emit("debug",l)}((r=this.events[t])!=null&&r.size||(h=this.onceCallbacks[t])!=null&&h.size)&&(this.emit("action",t),e.preventDefault()),this.emit("keydown",e),this.emit(t,e)});this._options=a(e,d),e.el&&this._prepareElement(e.el),t.length&&this.setActions(t),this._options.autoEnable&&this.enable()}get isEnabled(){return this._isEnabled}setActions(e){return this._unsubscribeActions(),this._actions=e,this._subscribeActions(),this.emit("setActions",e),this}enable(e){if(this._isEnabled&&this.disable(),e&&this._prepareElement(e),!(!this._options.el||typeof this._options.el!="object"))return this._isEnabled=!0,this._options.el.addEventListener("keydown",this._onKeyDown),this.emit("enable"),this}disable(){if(!(!this._options.el||typeof this._options.el!="object"))return this._isEnabled=!1,this._options.el.removeEventListener("keydown",this._onKeyDown),this.emit("disable"),this}destroy(){this.disable(),this._unsubscribeActions(),this._restoreElement(),this._options=d,this._actions=[],this.emit("destroy")}toggleDebug(e){return this._options.debug=e,this}_subscribeActions(){this._actions.forEach(({hotKey:e,callback:t})=>this.on(e,t))}_unsubscribeActions(){this._actions.forEach(({hotKey:e,callback:t})=>this.off(e,t))}_prepareElement(e){e&&(this._restoreElement(),this._options.el=v(e),this._options.el&&typeof this._options.tabindex=="number"&&(this._restoreTabindex=this._options.el.getAttribute("tabindex"),this._options.el.setAttribute("tabindex",String(this._options.tabindex))))}_restoreElement(){!this._options.el||typeof this._options.el!="object"||(this._restoreTabindex?this._options.el.setAttribute("tabindex",this._restoreTabindex):this._options.el.removeAttribute("tabindex"))}}n.HotKeysController=b,n.default=b,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
